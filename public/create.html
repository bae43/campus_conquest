<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en">

	<head>

		<title>Create Game | Campus Conquest</title>

		<meta charset="utf-8">

		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link rel="stylesheet" href="css/fonts.css" />
		<link rel="stylesheet" href="css/global.css" />
		<link rel="stylesheet" href="css/pane.css" />
		<style>
      .warning {
        padding: 10px 0 0;
        color: red;
        font-size: 12px;
      }
		</style>
		<script src="js/Constants.js"></script>

	</head>

	<body>

		<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>

		<div id='create-pane' style="display: block;">
			<div class='card'>
				<div class='card-contents'>

					<h1> Create Game</h1>
					<form id="create-game-form" style='margin-top: 5em;'>
						<div>
							Name:
							<div id="game-id-warning" class='warning' style="display: none;">
								*Required*
							</div>
							<input id="game_id" type="text" name="game_id" >
						</div>
						<div>
							Description:
							<input type="text" name="game_desc" >
						</div>
						<div style="display: none;">
							Public
							<div class='checkbox'>
								<input type="checkbox" name="privacy" id='is-public-checkbox'>
								<label for="is-public-checkbox"></label>
							</div>
						</div>
						<div style="display:none;">
							Private? (**Currently all games are public)

							<select name="privacy">
								<option value=0>Private</option>
								<option value=1>Public</option>
							</select>
						</div>
						<div>
							Teams
							<div id="team-min-warning" class='warning' style="display: none;">
								At least two teams must be selected
							</div>
							<ul id='team-list'></ul>
						</div>

						<div class='button-set right'>
							<a href="#" class="button" id="create-game-button" >Create Game</a>
						</div>
					</form>
				</div>

			</div>
		</div>

		<script>
      $(document).ready(function() {

        for (var id in TEAM_DATA) {
          $('#team-list').append('<li><label><input type="checkbox" name="' + id + '" value="true"/><img src="rsc/images/flags/128/' + id + '.jpg"> </label></li>');
        }

        $('#create-game-form').submit(function(e) {
          e.preventDefault();

          var error = false;
          $('.warning').hide();

          if (!$('#game_id').val() || $('#game_id').val() === "") {
            $('#game-id-warning').show();
            error = true;
          }
          // Prevents the page from refreshing
          var $this = $(this);

          var selected = [];
          $('#team-list input:checked').each(function() {
            selected.push($(this).attr('value'));
          });
          if (selected.length < 2) {
            $('#team-min-warning').show();
            error = true;
          }

          if (error) {
            return;
          }

/*        for (var id in TEAM_DATA) {
            data[id] = undefined;
          }
          data.teams = selected;
  */        


          $.post("/create-game", $(this).serialize(), function(data) {
            console.log('data', data);
            
          }, "json" // The format the response should be in
          );
          window.location.href = "/game";// + $('#game_id').val();
        });

        $("#create-game-button").click(function(e) {
          $('#create-game-form').submit();

        });

      });

		</script>
	</body>

</html>

